{"metadata":{"usedHelpers":["classCallCheck","interopRequireDefault"],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/packages/zurb:foundation-sites/js/foundation.drilldown.js","filenameRelative":"/packages/zurb:foundation-sites/js/foundation.drilldown.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/packages/zurb:foundation-sites/js/foundation.drilldown.js.map","sourceFileName":"/packages/zurb:foundation-sites/js/foundation.drilldown.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"foundation.drilldown"},"ignored":false,"code":"'use strict';\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n!function ($) {\n\n  /**\n   * Drilldown module.\n   * @module foundation.drilldown\n   * @requires foundation.util.keyboard\n   * @requires foundation.util.motion\n   * @requires foundation.util.nest\n   */\n\n  var Drilldown = function () {\n    /**\n     * Creates a new instance of a drilldown menu.\n     * @class\n     * @param {jQuery} element - jQuery object to make into an accordion menu.\n     * @param {Object} options - Overrides to the default plugin settings.\n     */\n\n    function Drilldown(element, options) {\n      (0, _classCallCheck3['default'])(this, Drilldown);\n\n      this.$element = element;\n      this.options = $.extend({}, Drilldown.defaults, this.$element.data(), options);\n\n      Foundation.Nest.Feather(this.$element, 'drilldown');\n\n      this._init();\n\n      Foundation.registerPlugin(this, 'Drilldown');\n      Foundation.Keyboard.register('Drilldown', {\n        'ENTER': 'open',\n        'SPACE': 'open',\n        'ARROW_RIGHT': 'next',\n        'ARROW_UP': 'up',\n        'ARROW_DOWN': 'down',\n        'ARROW_LEFT': 'previous',\n        'ESCAPE': 'close',\n        'TAB': 'down',\n        'SHIFT_TAB': 'up'\n      });\n    }\n\n    /**\n     * Initializes the drilldown by creating jQuery collections of elements\n     * @private\n     */\n\n\n    Drilldown.prototype._init = function () {\n      function _init() {\n        this.$submenuAnchors = this.$element.find('li.is-drilldown-submenu-parent').children('a');\n        this.$submenus = this.$submenuAnchors.parent('li').children('[data-submenu]');\n        this.$menuItems = this.$element.find('li').not('.js-drilldown-back').attr('role', 'menuitem').find('a');\n\n        this._prepareMenu();\n\n        this._keyboardEvents();\n      }\n\n      return _init;\n    }();\n\n    /**\n     * prepares drilldown menu by setting attributes to links and elements\n     * sets a min height to prevent content jumping\n     * wraps the element if not already wrapped\n     * @private\n     * @function\n     */\n\n\n    Drilldown.prototype._prepareMenu = function () {\n      function _prepareMenu() {\n        var _this = this;\n        // if(!this.options.holdOpen){\n        //   this._menuLinkEvents();\n        // }\n        this.$submenuAnchors.each(function () {\n          var $link = $(this);\n          var $sub = $link.parent();\n          if (_this.options.parentLink) {\n            $link.clone().prependTo($sub.children('[data-submenu]')).wrap('<li class=\"is-submenu-parent-item is-submenu-item is-drilldown-submenu-item\" role=\"menu-item\"></li>');\n          }\n          $link.data('savedHref', $link.attr('href')).removeAttr('href');\n          $link.children('[data-submenu]').attr({\n            'aria-hidden': true,\n            'tabindex': 0,\n            'role': 'menu'\n          });\n          _this._events($link);\n        });\n        this.$submenus.each(function () {\n          var $menu = $(this),\n              $back = $menu.find('.js-drilldown-back');\n          if (!$back.length) {\n            $menu.prepend(_this.options.backButton);\n          }\n          _this._back($menu);\n        });\n        if (!this.$element.parent().hasClass('is-drilldown')) {\n          this.$wrapper = $(this.options.wrapper).addClass('is-drilldown');\n          this.$wrapper = this.$element.wrap(this.$wrapper).parent().css(this._getMaxDims());\n        }\n      }\n\n      return _prepareMenu;\n    }();\n\n    /**\n     * Adds event handlers to elements in the menu.\n     * @function\n     * @private\n     * @param {jQuery} $elem - the current menu item to add handlers to.\n     */\n\n\n    Drilldown.prototype._events = function () {\n      function _events($elem) {\n        var _this = this;\n\n        $elem.off('click.zf.drilldown').on('click.zf.drilldown', function (e) {\n          if ($(e.target).parentsUntil('ul', 'li').hasClass('is-drilldown-submenu-parent')) {\n            e.stopImmediatePropagation();\n            e.preventDefault();\n          }\n\n          // if(e.target !== e.currentTarget.firstElementChild){\n          //   return false;\n          // }\n          _this._show($elem.parent('li'));\n\n          if (_this.options.closeOnClick) {\n            var $body = $('body');\n            $body.off('.zf.drilldown').on('click.zf.drilldown', function (e) {\n              if (e.target === _this.$element[0] || $.contains(_this.$element[0], e.target)) {\n                return;\n              }\n              e.preventDefault();\n              _this._hideAll();\n              $body.off('.zf.drilldown');\n            });\n          }\n        });\n      }\n\n      return _events;\n    }();\n\n    /**\n     * Adds keydown event listener to `li`'s in the menu.\n     * @private\n     */\n\n\n    Drilldown.prototype._keyboardEvents = function () {\n      function _keyboardEvents() {\n        var _this = this;\n\n        this.$menuItems.add(this.$element.find('.js-drilldown-back > a')).on('keydown.zf.drilldown', function (e) {\n\n          var $element = $(this),\n              $elements = $element.parent('li').parent('ul').children('li').children('a'),\n              $prevElement,\n              $nextElement;\n\n          $elements.each(function (i) {\n            if ($(this).is($element)) {\n              $prevElement = $elements.eq(Math.max(0, i - 1));\n              $nextElement = $elements.eq(Math.min(i + 1, $elements.length - 1));\n              return;\n            }\n          });\n\n          Foundation.Keyboard.handleKey(e, 'Drilldown', {\n            next: function () {\n              function next() {\n                if ($element.is(_this.$submenuAnchors)) {\n                  _this._show($element.parent('li'));\n                  $element.parent('li').one(Foundation.transitionend($element), function () {\n                    $element.parent('li').find('ul li a').filter(_this.$menuItems).first().focus();\n                  });\n                  return true;\n                }\n              }\n\n              return next;\n            }(),\n            previous: function () {\n              function previous() {\n                _this._hide($element.parent('li').parent('ul'));\n                $element.parent('li').parent('ul').one(Foundation.transitionend($element), function () {\n                  setTimeout(function () {\n                    $element.parent('li').parent('ul').parent('li').children('a').first().focus();\n                  }, 1);\n                });\n                return true;\n              }\n\n              return previous;\n            }(),\n            up: function () {\n              function up() {\n                $prevElement.focus();\n                return true;\n              }\n\n              return up;\n            }(),\n            down: function () {\n              function down() {\n                $nextElement.focus();\n                return true;\n              }\n\n              return down;\n            }(),\n            close: function () {\n              function close() {\n                _this._back();\n                //_this.$menuItems.first().focus(); // focus to first element\n              }\n\n              return close;\n            }(),\n            open: function () {\n              function open() {\n                if (!$element.is(_this.$menuItems)) {\n                  // not menu item means back button\n                  _this._hide($element.parent('li').parent('ul'));\n                  $element.parent('li').parent('ul').one(Foundation.transitionend($element), function () {\n                    setTimeout(function () {\n                      $element.parent('li').parent('ul').parent('li').children('a').first().focus();\n                    }, 1);\n                  });\n                } else if ($element.is(_this.$submenuAnchors)) {\n                  _this._show($element.parent('li'));\n                  $element.parent('li').one(Foundation.transitionend($element), function () {\n                    $element.parent('li').find('ul li a').filter(_this.$menuItems).first().focus();\n                  });\n                }\n                return true;\n              }\n\n              return open;\n            }(),\n            handled: function () {\n              function handled(preventDefault) {\n                if (preventDefault) {\n                  e.preventDefault();\n                }\n                e.stopImmediatePropagation();\n              }\n\n              return handled;\n            }()\n          });\n        }); // end keyboardAccess\n      }\n\n      return _keyboardEvents;\n    }();\n\n    /**\n     * Closes all open elements, and returns to root menu.\n     * @function\n     * @fires Drilldown#closed\n     */\n\n\n    Drilldown.prototype._hideAll = function () {\n      function _hideAll() {\n        var $elem = this.$element.find('.is-drilldown-submenu.is-active').addClass('is-closing');\n        $elem.one(Foundation.transitionend($elem), function (e) {\n          $elem.removeClass('is-active is-closing');\n        });\n        /**\n         * Fires when the menu is fully closed.\n         * @event Drilldown#closed\n         */\n        this.$element.trigger('closed.zf.drilldown');\n      }\n\n      return _hideAll;\n    }();\n\n    /**\n     * Adds event listener for each `back` button, and closes open menus.\n     * @function\n     * @fires Drilldown#back\n     * @param {jQuery} $elem - the current sub-menu to add `back` event.\n     */\n\n\n    Drilldown.prototype._back = function () {\n      function _back($elem) {\n        var _this = this;\n        $elem.off('click.zf.drilldown');\n        $elem.children('.js-drilldown-back').on('click.zf.drilldown', function (e) {\n          e.stopImmediatePropagation();\n          // console.log('mouseup on back');\n          _this._hide($elem);\n        });\n      }\n\n      return _back;\n    }();\n\n    /**\n     * Adds event listener to menu items w/o submenus to close open menus on click.\n     * @function\n     * @private\n     */\n\n\n    Drilldown.prototype._menuLinkEvents = function () {\n      function _menuLinkEvents() {\n        var _this = this;\n        this.$menuItems.not('.is-drilldown-submenu-parent').off('click.zf.drilldown').on('click.zf.drilldown', function (e) {\n          // e.stopImmediatePropagation();\n          setTimeout(function () {\n            _this._hideAll();\n          }, 0);\n        });\n      }\n\n      return _menuLinkEvents;\n    }();\n\n    /**\n     * Opens a submenu.\n     * @function\n     * @fires Drilldown#open\n     * @param {jQuery} $elem - the current element with a submenu to open, i.e. the `li` tag.\n     */\n\n\n    Drilldown.prototype._show = function () {\n      function _show($elem) {\n        $elem.children('[data-submenu]').addClass('is-active');\n        /**\n         * Fires when the submenu has opened.\n         * @event Drilldown#open\n         */\n        this.$element.trigger('open.zf.drilldown', [$elem]);\n      }\n\n      return _show;\n    }();\n\n    /**\n     * Hides a submenu\n     * @function\n     * @fires Drilldown#hide\n     * @param {jQuery} $elem - the current sub-menu to hide, i.e. the `ul` tag.\n     */\n\n    Drilldown.prototype._hide = function () {\n      function _hide($elem) {\n        var _this = this;\n        $elem.addClass('is-closing').one(Foundation.transitionend($elem), function () {\n          $elem.removeClass('is-active is-closing');\n          $elem.blur();\n        });\n        /**\n         * Fires when the submenu has closed.\n         * @event Drilldown#hide\n         */\n        $elem.trigger('hide.zf.drilldown', [$elem]);\n      }\n\n      return _hide;\n    }();\n\n    /**\n     * Iterates through the nested menus to calculate the min-height, and max-width for the menu.\n     * Prevents content jumping.\n     * @function\n     * @private\n     */\n\n\n    Drilldown.prototype._getMaxDims = function () {\n      function _getMaxDims() {\n        var max = 0,\n            result = {};\n        this.$submenus.add(this.$element).each(function () {\n          var numOfElems = $(this).children('li').length;\n          max = numOfElems > max ? numOfElems : max;\n        });\n\n        result['min-height'] = max * this.$menuItems[0].getBoundingClientRect().height + 'px';\n        result['max-width'] = this.$element[0].getBoundingClientRect().width + 'px';\n\n        return result;\n      }\n\n      return _getMaxDims;\n    }();\n\n    /**\n     * Destroys the Drilldown Menu\n     * @function\n     */\n\n\n    Drilldown.prototype.destroy = function () {\n      function destroy() {\n        this._hideAll();\n        Foundation.Nest.Burn(this.$element, 'drilldown');\n        this.$element.unwrap().find('.js-drilldown-back, .is-submenu-parent-item').remove().end().find('.is-active, .is-closing, .is-drilldown-submenu').removeClass('is-active is-closing is-drilldown-submenu').end().find('[data-submenu]').removeAttr('aria-hidden tabindex role');\n        this.$submenuAnchors.each(function () {\n          $(this).off('.zf.drilldown');\n        });\n        this.$element.find('a').each(function () {\n          var $link = $(this);\n          if ($link.data('savedHref')) {\n            $link.attr('href', $link.data('savedHref')).removeData('savedHref');\n          } else {\n            return;\n          }\n        });\n        Foundation.unregisterPlugin(this);\n      }\n\n      return destroy;\n    }();\n\n    return Drilldown;\n  }();\n\n  Drilldown.defaults = {\n    /**\n     * Markup used for JS generated back button. Prepended to submenu lists and deleted on `destroy` method, 'js-drilldown-back' class required. Remove the backslash (`\\`) if copy and pasting.\n     * @option\n     * @example '<\\li><\\a>Back<\\/a><\\/li>'\n     */\n    backButton: '<li class=\"js-drilldown-back\"><a tabindex=\"0\">Back</a></li>',\n    /**\n     * Markup used to wrap drilldown menu. Use a class name for independent styling; the JS applied class: `is-drilldown` is required. Remove the backslash (`\\`) if copy and pasting.\n     * @option\n     * @example '<\\div class=\"is-drilldown\"><\\/div>'\n     */\n    wrapper: '<div></div>',\n    /**\n     * Adds the parent link to the submenu.\n     * @option\n     * @example false\n     */\n    parentLink: false,\n    /**\n     * Allow the menu to return to root list on body click.\n     * @option\n     * @example false\n     */\n    closeOnClick: false\n    // holdOpen: false\n  };\n\n  // Window exports\n  Foundation.plugin(Drilldown, 'Drilldown');\n}(jQuery);","ast":null,"map":{"version":3,"sources":["/packages/zurb:foundation-sites/js/foundation.drilldown.js"],"names":[],"mappings":"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","file":"/packages/zurb:foundation-sites/js/foundation.drilldown.js.map","sourcesContent":["'use strict';\n\n!function($) {\n\n/**\n * Drilldown module.\n * @module foundation.drilldown\n * @requires foundation.util.keyboard\n * @requires foundation.util.motion\n * @requires foundation.util.nest\n */\n\nclass Drilldown {\n  /**\n   * Creates a new instance of a drilldown menu.\n   * @class\n   * @param {jQuery} element - jQuery object to make into an accordion menu.\n   * @param {Object} options - Overrides to the default plugin settings.\n   */\n  constructor(element, options) {\n    this.$element = element;\n    this.options = $.extend({}, Drilldown.defaults, this.$element.data(), options);\n\n    Foundation.Nest.Feather(this.$element, 'drilldown');\n\n    this._init();\n\n    Foundation.registerPlugin(this, 'Drilldown');\n    Foundation.Keyboard.register('Drilldown', {\n      'ENTER': 'open',\n      'SPACE': 'open',\n      'ARROW_RIGHT': 'next',\n      'ARROW_UP': 'up',\n      'ARROW_DOWN': 'down',\n      'ARROW_LEFT': 'previous',\n      'ESCAPE': 'close',\n      'TAB': 'down',\n      'SHIFT_TAB': 'up'\n    });\n  }\n\n  /**\n   * Initializes the drilldown by creating jQuery collections of elements\n   * @private\n   */\n  _init() {\n    this.$submenuAnchors = this.$element.find('li.is-drilldown-submenu-parent').children('a');\n    this.$submenus = this.$submenuAnchors.parent('li').children('[data-submenu]');\n    this.$menuItems = this.$element.find('li').not('.js-drilldown-back').attr('role', 'menuitem').find('a');\n\n    this._prepareMenu();\n\n    this._keyboardEvents();\n  }\n\n  /**\n   * prepares drilldown menu by setting attributes to links and elements\n   * sets a min height to prevent content jumping\n   * wraps the element if not already wrapped\n   * @private\n   * @function\n   */\n  _prepareMenu() {\n    var _this = this;\n    // if(!this.options.holdOpen){\n    //   this._menuLinkEvents();\n    // }\n    this.$submenuAnchors.each(function(){\n      var $link = $(this);\n      var $sub = $link.parent();\n      if(_this.options.parentLink){\n        $link.clone().prependTo($sub.children('[data-submenu]')).wrap('<li class=\"is-submenu-parent-item is-submenu-item is-drilldown-submenu-item\" role=\"menu-item\"></li>');\n      }\n      $link.data('savedHref', $link.attr('href')).removeAttr('href');\n      $link.children('[data-submenu]')\n          .attr({\n            'aria-hidden': true,\n            'tabindex': 0,\n            'role': 'menu'\n          });\n      _this._events($link);\n    });\n    this.$submenus.each(function(){\n      var $menu = $(this),\n          $back = $menu.find('.js-drilldown-back');\n      if(!$back.length){\n        $menu.prepend(_this.options.backButton);\n      }\n      _this._back($menu);\n    });\n    if(!this.$element.parent().hasClass('is-drilldown')){\n      this.$wrapper = $(this.options.wrapper).addClass('is-drilldown');\n      this.$wrapper = this.$element.wrap(this.$wrapper).parent().css(this._getMaxDims());\n    }\n  }\n\n  /**\n   * Adds event handlers to elements in the menu.\n   * @function\n   * @private\n   * @param {jQuery} $elem - the current menu item to add handlers to.\n   */\n  _events($elem) {\n    var _this = this;\n\n    $elem.off('click.zf.drilldown')\n    .on('click.zf.drilldown', function(e){\n      if($(e.target).parentsUntil('ul', 'li').hasClass('is-drilldown-submenu-parent')){\n        e.stopImmediatePropagation();\n        e.preventDefault();\n      }\n\n      // if(e.target !== e.currentTarget.firstElementChild){\n      //   return false;\n      // }\n      _this._show($elem.parent('li'));\n\n      if(_this.options.closeOnClick){\n        var $body = $('body');\n        $body.off('.zf.drilldown').on('click.zf.drilldown', function(e){\n          if (e.target === _this.$element[0] || $.contains(_this.$element[0], e.target)) { return; }\n          e.preventDefault();\n          _this._hideAll();\n          $body.off('.zf.drilldown');\n        });\n      }\n    });\n  }\n\n  /**\n   * Adds keydown event listener to `li`'s in the menu.\n   * @private\n   */\n  _keyboardEvents() {\n    var _this = this;\n\n    this.$menuItems.add(this.$element.find('.js-drilldown-back > a')).on('keydown.zf.drilldown', function(e){\n\n      var $element = $(this),\n          $elements = $element.parent('li').parent('ul').children('li').children('a'),\n          $prevElement,\n          $nextElement;\n\n      $elements.each(function(i) {\n        if ($(this).is($element)) {\n          $prevElement = $elements.eq(Math.max(0, i-1));\n          $nextElement = $elements.eq(Math.min(i+1, $elements.length-1));\n          return;\n        }\n      });\n\n      Foundation.Keyboard.handleKey(e, 'Drilldown', {\n        next: function() {\n          if ($element.is(_this.$submenuAnchors)) {\n            _this._show($element.parent('li'));\n            $element.parent('li').one(Foundation.transitionend($element), function(){\n              $element.parent('li').find('ul li a').filter(_this.$menuItems).first().focus();\n            });\n            return true;\n          }\n        },\n        previous: function() {\n          _this._hide($element.parent('li').parent('ul'));\n          $element.parent('li').parent('ul').one(Foundation.transitionend($element), function(){\n            setTimeout(function() {\n              $element.parent('li').parent('ul').parent('li').children('a').first().focus();\n            }, 1);\n          });\n          return true;\n        },\n        up: function() {\n          $prevElement.focus();\n          return true;\n        },\n        down: function() {\n          $nextElement.focus();\n          return true;\n        },\n        close: function() {\n          _this._back();\n          //_this.$menuItems.first().focus(); // focus to first element\n        },\n        open: function() {\n          if (!$element.is(_this.$menuItems)) { // not menu item means back button\n            _this._hide($element.parent('li').parent('ul'));\n            $element.parent('li').parent('ul').one(Foundation.transitionend($element), function(){\n              setTimeout(function() {\n                $element.parent('li').parent('ul').parent('li').children('a').first().focus();\n              }, 1);\n            });\n          } else if ($element.is(_this.$submenuAnchors)) {\n            _this._show($element.parent('li'));\n            $element.parent('li').one(Foundation.transitionend($element), function(){\n              $element.parent('li').find('ul li a').filter(_this.$menuItems).first().focus();\n            });\n          }\n          return true;\n        },\n        handled: function(preventDefault) {\n          if (preventDefault) {\n            e.preventDefault();\n          }\n          e.stopImmediatePropagation();\n        }\n      });\n    }); // end keyboardAccess\n  }\n\n  /**\n   * Closes all open elements, and returns to root menu.\n   * @function\n   * @fires Drilldown#closed\n   */\n  _hideAll() {\n    var $elem = this.$element.find('.is-drilldown-submenu.is-active').addClass('is-closing');\n    $elem.one(Foundation.transitionend($elem), function(e){\n      $elem.removeClass('is-active is-closing');\n    });\n        /**\n         * Fires when the menu is fully closed.\n         * @event Drilldown#closed\n         */\n    this.$element.trigger('closed.zf.drilldown');\n  }\n\n  /**\n   * Adds event listener for each `back` button, and closes open menus.\n   * @function\n   * @fires Drilldown#back\n   * @param {jQuery} $elem - the current sub-menu to add `back` event.\n   */\n  _back($elem) {\n    var _this = this;\n    $elem.off('click.zf.drilldown');\n    $elem.children('.js-drilldown-back')\n      .on('click.zf.drilldown', function(e){\n        e.stopImmediatePropagation();\n        // console.log('mouseup on back');\n        _this._hide($elem);\n      });\n  }\n\n  /**\n   * Adds event listener to menu items w/o submenus to close open menus on click.\n   * @function\n   * @private\n   */\n  _menuLinkEvents() {\n    var _this = this;\n    this.$menuItems.not('.is-drilldown-submenu-parent')\n        .off('click.zf.drilldown')\n        .on('click.zf.drilldown', function(e){\n          // e.stopImmediatePropagation();\n          setTimeout(function(){\n            _this._hideAll();\n          }, 0);\n      });\n  }\n\n  /**\n   * Opens a submenu.\n   * @function\n   * @fires Drilldown#open\n   * @param {jQuery} $elem - the current element with a submenu to open, i.e. the `li` tag.\n   */\n  _show($elem) {\n    $elem.children('[data-submenu]').addClass('is-active');\n    /**\n     * Fires when the submenu has opened.\n     * @event Drilldown#open\n     */\n    this.$element.trigger('open.zf.drilldown', [$elem]);\n  };\n\n  /**\n   * Hides a submenu\n   * @function\n   * @fires Drilldown#hide\n   * @param {jQuery} $elem - the current sub-menu to hide, i.e. the `ul` tag.\n   */\n  _hide($elem) {\n    var _this = this;\n    $elem.addClass('is-closing')\n         .one(Foundation.transitionend($elem), function(){\n           $elem.removeClass('is-active is-closing');\n           $elem.blur();\n         });\n    /**\n     * Fires when the submenu has closed.\n     * @event Drilldown#hide\n     */\n    $elem.trigger('hide.zf.drilldown', [$elem]);\n  }\n\n  /**\n   * Iterates through the nested menus to calculate the min-height, and max-width for the menu.\n   * Prevents content jumping.\n   * @function\n   * @private\n   */\n  _getMaxDims() {\n    var max = 0, result = {};\n    this.$submenus.add(this.$element).each(function(){\n      var numOfElems = $(this).children('li').length;\n      max = numOfElems > max ? numOfElems : max;\n    });\n\n    result['min-height'] = `${max * this.$menuItems[0].getBoundingClientRect().height}px`;\n    result['max-width'] = `${this.$element[0].getBoundingClientRect().width}px`;\n\n    return result;\n  }\n\n  /**\n   * Destroys the Drilldown Menu\n   * @function\n   */\n  destroy() {\n    this._hideAll();\n    Foundation.Nest.Burn(this.$element, 'drilldown');\n    this.$element.unwrap()\n                 .find('.js-drilldown-back, .is-submenu-parent-item').remove()\n                 .end().find('.is-active, .is-closing, .is-drilldown-submenu').removeClass('is-active is-closing is-drilldown-submenu')\n                 .end().find('[data-submenu]').removeAttr('aria-hidden tabindex role');\n    this.$submenuAnchors.each(function() {\n      $(this).off('.zf.drilldown');\n    });\n    this.$element.find('a').each(function(){\n      var $link = $(this);\n      if($link.data('savedHref')){\n        $link.attr('href', $link.data('savedHref')).removeData('savedHref');\n      }else{ return; }\n    });\n    Foundation.unregisterPlugin(this);\n  };\n}\n\nDrilldown.defaults = {\n  /**\n   * Markup used for JS generated back button. Prepended to submenu lists and deleted on `destroy` method, 'js-drilldown-back' class required. Remove the backslash (`\\`) if copy and pasting.\n   * @option\n   * @example '<\\li><\\a>Back<\\/a><\\/li>'\n   */\n  backButton: '<li class=\"js-drilldown-back\"><a tabindex=\"0\">Back</a></li>',\n  /**\n   * Markup used to wrap drilldown menu. Use a class name for independent styling; the JS applied class: `is-drilldown` is required. Remove the backslash (`\\`) if copy and pasting.\n   * @option\n   * @example '<\\div class=\"is-drilldown\"><\\/div>'\n   */\n  wrapper: '<div></div>',\n  /**\n   * Adds the parent link to the submenu.\n   * @option\n   * @example false\n   */\n  parentLink: false,\n  /**\n   * Allow the menu to return to root list on body click.\n   * @option\n   * @example false\n   */\n  closeOnClick: false\n  // holdOpen: false\n};\n\n// Window exports\nFoundation.plugin(Drilldown, 'Drilldown');\n\n}(jQuery);\n"]},"hash":"bf556b50bba600ebc179fad529801711723eabbc"}
